<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../.resources/report.gif" type="image/gif"/><title>Caches.java</title><link rel="stylesheet" href="../../../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../.sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">Smuggler All Tests (Mar 29, 2016 9:20:39 AM)</a> &gt; <a href="../../index.html" class="el_group">ome-smuggler</a> &gt; <a href="../index.html" class="el_bundle">src/main/java</a> &gt; <a href="index.source.html" class="el_package">util.servlet.http</a> &gt; <span class="el_source">Caches.java</span></div><h1>Caches.java</h1><pre class="source lang-java linenums">package util.servlet.http;

import static java.util.Objects.requireNonNull;

import java.util.StringJoiner;

import javax.servlet.http.HttpServletResponse;

/**
 * Helper methods for resource caching strategies.
 */
<span class="nc" id="L12">public class Caches {</span>
    
    public static final String CacheControl = &quot;Cache-Control&quot;;
    public static final String Pragma = &quot;Pragma&quot;;
    public static final String Expires = &quot;Expires&quot;;
    public static final String NoStore = &quot;no-store&quot;; 
    public static final String NoCache = &quot;no-cache&quot;;
    public static final String MustRevalidate = &quot;must-revalidate&quot;;
    public static String MaxAge(int seconds) { 
<span class="fc" id="L21">        return &quot;max-age=&quot; + seconds;</span>
    }
    
    /**
     * Sets headers so that the response is never cached.
     * @param response the response on which to set the headers.
     * @throws NullPointerException if the argument is {@code null}. 
     */
    public static void doNotCache(HttpServletResponse response) {
<span class="fc" id="L30">        requireNonNull(response, &quot;response&quot;);</span>
        
<span class="fc" id="L32">        response.setHeader(CacheControl, new StringJoiner(&quot;, &quot;)</span>
<span class="fc" id="L33">                                        .add(NoStore)</span>
<span class="fc" id="L34">                                        .add(NoCache)</span>
<span class="fc" id="L35">                                        .add(MustRevalidate)</span>
<span class="fc" id="L36">                                        .toString());</span>
<span class="fc" id="L37">        response.setHeader(Pragma, NoCache);</span>
<span class="fc" id="L38">        response.setIntHeader(Expires, 0);</span>
<span class="fc" id="L39">    }</span>
    /* See:
     * - http://stackoverflow.com/questions/49547/making-sure-a-web-page-is-not-cached-across-all-browsers
     * - https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/http-caching?hl=en
     */
    
    /**
     * Sets headers so that the response is cached for as long as possible.
     * The HTTP standard advises this should be at most one year in the future.
     * @param response the response on which to set the headers.
     * @throws NullPointerException if the argument is {@code null}.
     */
    public static void cacheForAsLongAsPossible(HttpServletResponse response) {
<span class="fc" id="L52">        requireNonNull(response, &quot;response&quot;);</span>
        
<span class="fc" id="L54">        response.setHeader(CacheControl, MaxAge(60*60*24*365));</span>
<span class="fc" id="L55">    }</span>
    /* See:
     * - http://stackoverflow.com/questions/7071763/max-value-for-cache-control-header-in-http
     * - http://stackoverflow.com/questions/5799906/what-s-the-difference-between-expires-and-cache-control-headers
     * - https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/http-caching?hl=en
     */
    
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span>Smuggler All Tests (Mar 29, 2016 9:20:39 AM)</div></body></html>